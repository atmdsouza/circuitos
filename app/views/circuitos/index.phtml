<?php

use Util\Util;

?>

<div class="col-12">
    <div class="card-box">
        <table id="tb_circuitos" class="table table-striped table-bordered" cellspacing="0" width="100%">
            <thead>
                <tr>
                    <th>Código</th>
                    <th>Designação</th>
                    <th>Cliente</th>
                    <th>Unidade</th>
                    <th>Função</th>
                    <th>Enlace</th>
                    <th>Banda</th>
                    <th>Data Cadastro</th>
                    <th>Data Atualização</th>
                    <th>Status</th>
                </tr>
            </thead>
            <tbody>
                <?php foreach ($page->items as $circuitos): ?>
                <?php            
                $util = new Util();
                $data_cadastro = ($circuitos->data_ativacao) ? $util->converterDataHoraParaBr($circuitos->data_ativacao) : null;
                $data_atualizacao = ($circuitos->data_atualizacao) ? $util->converterDataHoraParaBr($circuitos->data_atualizacao) : null;
                switch($circuitos->Cliente->id_tipocliente)
                {
                    case "45"://Pessoa Física
                        $unidade = null;
                    break;
                    case "44"://Pessoa Jurídica
                        $unidade = $circuitos->ClienteUnidade->Pessoa->nome;
                    break;
                }
            ?>
                <tr>
                    <td>
                        <?php echo $circuitos->id ?>
                    </td>
                    <td>
                        <?php echo $circuitos->designacao ?>
                    </td>
                    <td>
                        <?php echo $circuitos->Cliente->Pessoa->nome ?>
                    </td>
                    <td>
                        <?php echo $unidade ?>
                    </td>
                    <td>
                        <?php echo $circuitos->Lov5->descricao ?>
                    </td>
                    <td>
                        <?php echo $circuitos->Lov6->descricao ?>
                    </td>
                    <td>
                        <?php echo $circuitos->Lov7->descricao ?>
                    </td>
                    <td>
                        <?php echo $data_cadastro ?>
                    </td>
                    <td>
                        <?php echo $data_atualizacao ?>
                    </td>
                    <td>
                        <?php echo $circuitos->Lov2->descricao ?>
                    </td>
                </tr>
                <?php endforeach; ?>
            </tbody>
        </table>
    </div>
</div>

<!--  Modal Circuitos -->
<div id="modalcircuitos" class="modal fade" tabindex="-1" role="dialog" aria-labelledby="modalcircuitos" aria-hidden="true"
    style="display: none;" data-backdrop="static" data-keyboard="false">
    <div class="modal-dialog modal-xl">
        <div class="modal-content">
            <div class="modal-header">
                <button type="button" class="close" data-dismiss="modal" aria-hidden="true">×</button>
                <h5 class="modal-title" id="modalcircuitos">Dados do Circuito</h5>
            </div>
            <form id="formCircuitos">
                <input type="hidden" id="token" name="<?php echo $token['tokenKey'] ?>" value="<?php echo $token['tokenValue'] ?>">
                <!-- CSRFToken Control -->
                <div class="modal-body">
                    <div class="form-row">
                        <div class="col-12">
                            <div class="form-row">
                                <div class="form-group col-md-3">
                                    <input type="hidden" id="tipocliente" name="tipocliente" value=""><!-- Manter como hidden -->
                                    <label for="id_cliente">Cliente</label>
                                    <?php echo $this->tag->select(["id_cliente", $clientes, "class" => "form-control", "id" => "id_cliente",
                                        "using" => ["id", "nome",],
                                        "useEmpty" => true,
                                        "emptyText" => "Selecione um Cliente",
                                        "emptyValue" => ""])
                                    ?>
                                </div>
                                <div class="form-group col-md-3">
                                    <label for="id_cliente_unidade">Unidade do Cliente</label>
                                    <select disabled name="id_cliente_unidade" id="id_cliente_unidade" class="form-control">
                                        <option value="">Selecione uma Unidade</option>
                                    </select>
                                </div>
                                <div class="form-group col-md-3">
                                    <label for="designacao">Designação</label>
                                    <?php echo $this->tag->textField(["designacao", "size" => 60, "class" => "form-control", "id" => "designacao", "placeholder" => "Designação"]) ?>
                                </div>
                                <div class="form-group col-md-3">
                                    <label for="duracao">VLAN</label>
                                    <?php echo $this->tag->textField(["vlan", "size" => 60, "class" => "form-control", "id" => "vlan", "placeholder" => "VLAN"]) ?>
                                </div>
                            </div>
                            <div class="form-row">
                                <div class="form-group col-md-3">
                                    <label for="id_contrato">Contrato</label>
                                    <?php echo $this->tag->select(["id_contrato", $usacontrato, "class" => "form-control", "id" => "id_contrato",
                                        "using" => ["id", "descricao",],
                                        "useEmpty" => true,
                                        "emptyText" => "Selecione o tipo de Contrato",
                                        "emptyValue" => ""])
                                    ?>
                                </div>
                                <div class="form-group col-md-3">
                                    <label for="id_cluster">Cluster</label>
                                    <?php echo $this->tag->select(["id_cluster", $cluster, "class" => "form-control", "id" => "id_cluster",
                                        "using" => ["id", "descricao",],
                                        "useEmpty" => true,
                                        "emptyText" => "Selecione um Cluster",
                                        "emptyValue" => ""])
                                    ?>
                                </div>
                                <div class="form-group col-md-3">
                                    <label for="id_tipounidade">Tipo Unidade</label>
                                    <?php echo $this->tag->select(["id_tipounidade", $tipounindade, "class" => "form-control", "id" => "id_tipounidade",
                                        "using" => ["id", "descricao",],
                                        "useEmpty" => true,
                                        "emptyText" => "Selecione o tipo de Unidade",
                                        "emptyValue" => ""])
                                    ?>
                                </div>
                                <div class="form-group col-md-3">
                                    <label for="id_funcao">Função</label>
                                    <?php echo $this->tag->select(["id_funcao", $funcao, "class" => "form-control", "id" => "id_funcao",
                                        "using" => ["id", "descricao",],
                                        "useEmpty" => true,
                                        "emptyText" => "Selecione a Função",
                                        "emptyValue" => ""])
                                    ?>
                                </div>
                            </div>
                            <div class="form-row">
                                <div class="form-group col-md-3">
                                    <label for="id_enlace">Enlace</label>
                                    <?php echo $this->tag->select(["id_enlace", $enlace, "class" => "form-control", "id" => "id_enlace",
                                        "using" => ["id", "descricao",],
                                        "useEmpty" => true,
                                        "emptyText" => "Selecione o Enlace",
                                        "emptyValue" => ""])
                                    ?>
                                </div>
                                <div class="form-group col-md-3">
                                    <label for="id_fabricante">Fabricante</label>
                                    <?php echo $this->tag->select(["id_fabricante", $fabricantes, "class" => "form-control", "id" => "id_fabricante",
                                        "using" => ["id", "nome",],
                                        "useEmpty" => true,
                                        "emptyText" => "Selecione um Fabricante",
                                        "emptyValue" => ""])
                                    ?>
                                </div>
                                <div class="form-group col-md-3">
                                    <label for="id_modelo">Modelo</label>
                                    <select disabled name="id_modelo" id="id_modelo" class="form-control">
                                        <option value="">Selecione um Modelo</option>
                                    </select>
                                </div>
                                <div class="form-group col-md-3">
                                    <label for="id_equipamento">Equipamento</label>
                                    <select disabled name="id_equipamento" id="id_equipamento" class="form-control">
                                        <option value="">Selecione um Equipamento</option>
                                    </select>
                                </div>
                            </div>
                            <div class="form-row">
                                <div class="form-group col-md-3">
                                    <label for="ip_redelocal">IP Rede Local</label>
                                    <?php echo $this->tag->textField(["ip_redelocal", "size" => 30, "class" => "form-control", "id" => "ip_redelocal", "placeholder" => "IP Rede Local"]) ?>
                                </div>
                                <div class="form-group col-md-3">
                                    <label for="ip_gerencia">IP Rede Gerencial</label>
                                    <?php echo $this->tag->textField(["ip_gerencia", "size" => 30, "class" => "form-control", "id" => "ip_gerencia", "placeholder" => "IP Rede Gerencial"]) ?>
                                </div>
                                <div class="form-group col-md-2">
                                    <label for="ccode">CCODE</label>
                                    <?php echo $this->tag->textField(["ccode", "size" => 30, "class" => "form-control", "id" => "ccode", "placeholder" => "CCODE"]) ?>
                                </div>
                                <div class="form-group col-md-2">
                                    <label for="tag">TAG</label>
                                    <?php echo $this->tag->textField(["tag", "size" => 120, "class" => "form-control", "id" => "tag", "placeholder" => "TAG"]) ?>
                                </div>
                                <div class="form-group col-md-2">
                                    <label for="banda">Banda</label>
                                    <?php echo $this->tag->select(["banda", $banda, "class" => "form-control", "id" => "banda",
                                        "using" => ["id", "descricao",],
                                        "useEmpty" => true,
                                        "emptyText" => "Selecione a Banda",
                                        "emptyValue" => ""])
                                    ?>
                                </div>
                            </div>
                            <div class="form-row">
                                <div class="form-group col-md-12">
                                    <label for="observacao">Observação</label>
                                    <?php echo $this->tag->textArea(["observacao", "size" => 400, "class" => "form-control", "id" => "observacao", "placeholder" => "Observação"]) ?>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="modal-footer">
                    <input type="hidden" id="id" name="id" value=""><!-- Manter como hidden -->
                    <button type="button" class="btn btn-secondary btn-rounded waves-effect limpar_modal" onclick="limparModal()" data-dismiss="modal">Fechar</button>
                    <button id="salvaCircuitos" type="submit" class="btn btn-primary btn-rounded waves-effect waves-light">Salvar</button>
                </div><!-- /.modal-footer -->
            </form>
        </div><!-- /.modal-content -->
    </div><!-- /.modal-dialog -->
</div><!-- /.modal -->

<!--  Modal Visualizar -->
<div id="modalvisualizar" class="modal fade" tabindex="-1" role="dialog" aria-labelledby="modalvisualizar" aria-hidden="true"
    style="display: none;" data-backdrop="static" data-keyboard="false">
    <div class="modal-dialog modal-xl">
        <div class="modal-content">
            <div class="modal-header">
                <button type="button" class="close" data-dismiss="modal" aria-hidden="true">×</button>
                <h5 class="modal-title" id="modalvisualizar">Visualizar Circuito</h5>
            </div>
            <form id="formVisualizar">
                <input type="hidden" id="token" name="<?php echo $token['tokenKey'] ?>" value="<?php echo $token['tokenValue'] ?>">
                <!-- CSRFToken Control -->
                <div class="modal-body">
                    <div class="form-row">
                        <div class="col-12">
                            <div class="form-row">
                                <div class="form-group col-md-3">
                                    <label for="id_statusv">Status</label>
                                    <?php echo $this->tag->select(["id_statusv", $statuscircuito, "class" => "form-control", "id" => "id_statusv",
                                        "using" => ["id", "descricao",],
                                        "useEmpty" => true,
                                        "emptyText" => "Selecione um Status",
                                        "emptyValue" => ""])
                                    ?>
                                </div>
                            </div>
                            <div class="form-row">
                                <div class="form-group col-md-3">
                                    <label for="id_cliente">Cliente</label>
                                    <?php echo $this->tag->select(["id_clientev", $clientes, "class" => "form-control", "id" => "id_clientev",
                                        "using" => ["id", "nome",],
                                        "useEmpty" => true,
                                        "emptyText" => "Selecione um Cliente",
                                        "emptyValue" => ""])
                                    ?>
                                </div>
                                <div class="form-group col-md-3">
                                    <label for="id_cliente_unidadev">Cliente Unidade</label>
                                    <?php echo $this->tag->select(["id_cliente_unidadev", $unidades, "class" => "form-control", "id" => "id_cliente_unidadev",
                                        "using" => ["id", "nome",],
                                        "useEmpty" => true,
                                        "emptyText" => "Selecione uma Unidade",
                                        "emptyValue" => ""])
                                    ?>
                                </div>
                                <div class="form-group col-md-3">
                                    <label for="designacaov">Designação</label>
                                    <?php echo $this->tag->textField(["designacaov", "size" => 60, "class" => "form-control", "id" => "designacaov", "placeholder" => "Designação"]) ?>
                                </div>
                                <div class="form-group col-md-3">
                                    <label for="vlanv">VLAN</label>
                                    <?php echo $this->tag->textField(["vlanv", "size" => 60, "class" => "form-control", "id" => "vlanv", "placeholder" => "VLAN"]) ?>
                                </div>
                            </div>
                            <div class="form-row">
                                <div class="form-group col-md-3">
                                    <label for="id_contratov">Contrato</label>
                                    <?php echo $this->tag->select(["id_contratov", $usacontrato, "class" => "form-control", "id" => "id_contratov",
                                        "using" => ["id", "descricao",],
                                        "useEmpty" => true,
                                        "emptyText" => "Selecione o tipo de Contrato",
                                        "emptyValue" => ""])
                                    ?>
                                </div>
                                <div class="form-group col-md-3">
                                    <label for="id_clusterv">Cluster</label>
                                    <?php echo $this->tag->select(["id_clusterv", $cluster, "class" => "form-control", "id" => "id_clusterv",
                                        "using" => ["id", "descricao",],
                                        "useEmpty" => true,
                                        "emptyText" => "Selecione um Cluster",
                                        "emptyValue" => ""])
                                    ?>
                                </div>
                                <div class="form-group col-md-3">
                                    <label for="id_tipounidadev">Tipo de Unidade</label>
                                    <?php echo $this->tag->select(["id_tipounidadev", $tipounindade, "class" => "form-control", "id" => "id_tipounidadev",
                                        "using" => ["id", "descricao",],
                                        "useEmpty" => true,
                                        "emptyText" => "Selecione o tipo de Unidade",
                                        "emptyValue" => ""])
                                    ?>
                                </div>
                                <div class="form-group col-md-3">
                                    <label for="id_funcaov">Função</label>
                                    <?php echo $this->tag->select(["id_funcaov", $funcao, "class" => "form-control", "id" => "id_funcaov",
                                        "using" => ["id", "descricao",],
                                        "useEmpty" => true,
                                        "emptyText" => "Selecione a Função",
                                        "emptyValue" => ""])
                                    ?>
                                </div>
                            </div>
                            <div class="form-row">
                                <div class="form-group col-md-3">
                                    <label for="id_enlacev">Enlace</label>
                                    <?php echo $this->tag->select(["id_enlacev", $enlace, "class" => "form-control", "id" => "id_enlacev",
                                        "using" => ["id", "descricao",],
                                        "useEmpty" => true,
                                        "emptyText" => "Selecione o Enlace",
                                        "emptyValue" => ""])
                                    ?>
                                </div>
                                <div class="form-group col-md-3">
                                    <label for="id_fabricantev">Fabricante</label>
                                    <?php echo $this->tag->select(["id_fabricantev", $fabricantes, "class" => "form-control", "id" => "id_fabricantev",
                                        "using" => ["id", "nome",],
                                        "useEmpty" => true,
                                        "emptyText" => "Selecione um Fabricante",
                                        "emptyValue" => ""])
                                    ?>
                                </div>
                                <div class="form-group col-md-3">
                                    <label for="id_modelov">Modelo</label>
                                    <?php echo $this->tag->select(["id_modelov", $modelos, "class" => "form-control", "id" => "id_modelov",
                                        "using" => ["id", "modelo",],
                                        "useEmpty" => true,
                                        "emptyText" => "Selecione um Modelo",
                                        "emptyValue" => ""])
                                    ?>
                                </div>
                                <div class="form-group col-md-3">
                                    <label for="id_equipamentov">Equipamento</label>
                                    <?php echo $this->tag->select(["id_equipamentov", $equipamentos, "class" => "form-control", "id" => "id_equipamentov",
                                        "using" => ["id", "nome",],
                                        "useEmpty" => true,
                                        "emptyText" => "Selecione um Equipamento",
                                        "emptyValue" => ""])
                                    ?>
                                </div>
                            </div>
                            <div class="form-row">
                                <div class="form-group col-md-3">
                                    <label for="ip_redelocalv">IP Rede Local</label>
                                    <?php echo $this->tag->textField(["ip_redelocalv", "size" => 30, "class" => "form-control", "id" => "ip_redelocalv", "placeholder" => "IP Rede Local"]) ?>
                                </div>
                                <div class="form-group col-md-3">
                                    <label for="ip_gerenciav">IP Rede Gerencial</label>
                                    <?php echo $this->tag->textField(["ip_gerenciav", "size" => 30, "class" => "form-control", "id" => "ip_gerenciav", "placeholder" => "IP Rede Gerencial"]) ?>
                                </div>
                                <div class="form-group col-md-2">
                                    <label for="ccodev">CCODE</label>
                                    <?php echo $this->tag->textField(["ccodev", "size" => 30, "class" => "form-control", "id" => "ccodev", "placeholder" => "CCODE"]) ?>
                                </div>
                                <div class="form-group col-md-2">
                                    <label for="tagv">TAG</label>
                                    <?php echo $this->tag->textField(["tagv", "size" => 120, "class" => "form-control", "id" => "tagv", "placeholder" => "TAG"]) ?>
                                </div>
                                <div class="form-group col-md-2">
                                    <label for="banda">Banda</label>
                                    <?php echo $this->tag->select(["bandav", $banda, "class" => "form-control", "id" => "bandav",
                                        "using" => ["id", "descricao",],
                                        "useEmpty" => true,
                                        "emptyText" => "Selecione a Banda",
                                        "emptyValue" => ""])
                                    ?>
                                </div>
                            </div>
                            <div class="form-row">
                                <div class="form-group col-md-12">
                                    <label for="observacaov">Observação</label>
                                    <?php echo $this->tag->textArea(["observacaov", "size" => 400, "class" => "form-control", "id" => "observacaov", "placeholder" => "Observação"]) ?>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary btn-rounded waves-effect limpar_modal" onclick="limparModal()" data-dismiss="modal">Fechar</button>
                    <button id="pdfCircuito" type="button" class="btn btn-primary btn-rounded waves-effect waves-light">Gerar PDF</button>
                </div><!-- /.modal-footer -->
            </form>
        </div><!-- /.modal-content -->
    </div><!-- /.modal-dialog -->
</div><!-- /.modal -->

<!--  Modal Movimento -->
<div id="modalcircuitosmov" class="modal fade" tabindex="-1" role="dialog" aria-labelledby="modalcircuitosmov" aria-hidden="true"
    style="display: none;" data-backdrop="static" data-keyboard="false">
    <div class="modal-dialog modal-lg">
        <div class="modal-content">
            <div class="modal-header">
                <button type="button" class="close" data-dismiss="modal" aria-hidden="true">×</button>
                <h5 class="modal-title" id="modalcircuitosmov">Dados do Movimento</h5>
            </div>
            <form id="formCircuitosmov">
                <input type="hidden" id="token" name="<?php echo $token['tokenKey'] ?>" value="<?php echo $token['tokenValue'] ?>">
                <!-- CSRFToken Control -->
                <div class="modal-body">
                    <div class="form-row">
                        <div class="col-12">
                            <div class="form-row">
                                <div class="form-group col-md-4">
                                    <input type="hidden" id="id_circuito" name="id_circuito" value=""><!-- Manter como hidden -->
                                    <label for="id_tipomovimento">Tipo de Movimento</label>
                                    <?php echo $this->tag->select(["id_tipomovimento", $tipomovimento, "class" => "form-control", "id" => "id_tipomovimento",
                                        "using" => ["id", "descricao",],
                                        "useEmpty" => true,
                                        "emptyText" => "Selecione um tipo",
                                        "emptyValue" => ""])
                                    ?>
                                </div>
                                <div class="form-group col-md-4">
                                    <label for="osocomon">Nº Ordem de Serviço</label>
                                    <?php echo $this->tag->textField(["osocomon", "size" => 60, "class" => "form-control", "id" => "osocomon", "placeholder" => "Nº Ordem de Serviço"]) ?>
                                </div>
                                <div id="bandamovdiv" class="form-group col-md-4" style="display: none;">
                                    <label for="bandamov">Banda</label>
                                    <?php echo $this->tag->select(["bandamov", $banda, "class" => "form-control", "id" => "bandamov",
                                        "using" => ["id", "descricao",],
                                        "useEmpty" => true,
                                        "emptyText" => "Selecione a Banda",
                                        "emptyValue" => ""])
                                    ?>
                                </div>
                                <div id="redelocalmovdiv" class="form-group col-md-4" style="display: none;">
                                    <label for="ip_redelocalmov">IP Rede Local</label>
                                    <?php echo $this->tag->textField(["ip_redelocalmov", "size" => 30, "class" => "form-control", "id" => "ip_redelocalmov", "placeholder" => "IP Rede Local"]) ?>
                                </div>
                                <div id="gerenciamovdiv" class="form-group col-md-4" style="display: none;">
                                    <label for="ip_gerenciamov">IP Rede Gerencial</label>
                                    <?php echo $this->tag->textField(["ip_gerenciamov", "size" => 30, "class" => "form-control", "id" => "ip_gerenciamov", "placeholder" => "IP Rede Gerencial"]) ?>
                                </div>
                                <div id="statusmovdiv" class="form-group col-md-4" style="display: none;">
                                    <label for="id_statusmov">Status</label>
                                    <?php echo $this->tag->select(["id_statusmov", $statuscircuito, "class" => "form-control", "id" => "id_statusmov",
                                        "using" => ["id", "descricao",],
                                        "useEmpty" => true,
                                        "emptyText" => "Selecione um Status",
                                        "emptyValue" => ""])
                                    ?>
                                </div>
                                <div class="form-group col-md-4 equip" style="display: none;">
                                    <label for="id_fabricantemov">Fabricante</label>
                                    <?php echo $this->tag->select(["id_fabricantemov", $fabricantes, "class" => "form-control", "id" => "id_fabricantemov",
                                        "using" => ["id", "nome",],
                                        "useEmpty" => true,
                                        "emptyText" => "Selecione um Fabricante",
                                        "emptyValue" => ""])
                                    ?>
                                </div>
                                <div class="form-group col-md-4 equip" style="display: none;">
                                    <label for="id_modelomov">Modelo</label>
                                    <select disabled name="id_modelomov" id="id_modelomov" class="form-control">
                                        <option value="">Selecione um Modelo</option>
                                    </select>
                                </div>
                                <div class="form-group col-md-4 equip" style="display: none;">
                                    <label for="id_equipamentomov">Equipamento</label>
                                    <select disabled name="id_equipamentomov" id="id_equipamentomov" class="form-control">
                                        <option value="">Selecione um Equipamento</option>
                                    </select>
                                </div>
                            </div>
                            <div class="form-row">
                                <div class="form-group col-md-12">
                                    <label for="observacaomov">Observação</label>
                                    <?php echo $this->tag->textArea(["observacaomov", "size" => 400, "class" => "form-control", "id" => "observacaomov", "placeholder" => "Observação"]) ?>
                                </div>
                            </div>
                            <div class="form-row" style="display: none;">
                                <div class="form-group col-md-4">
                                    <label for="observacaomov">Observação</label>
                                    <?php echo $this->tag->textArea(["observacaomov", "size" => 400, "class" => "form-control", "id" => "observacaomov", "placeholder" => "Observação"]) ?>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="modal-footer">
                    <input type="hidden" id="idmov" name="idmov" value=""><!-- Manter como hidden -->
                    <button type="button" class="btn btn-secondary btn-rounded waves-effect limpar_modal" onclick="limparModal()" data-dismiss="modal">Fechar</button>
                    <button disabled id="salvaCircuitosmov" type="submit" class="btn btn-primary btn-rounded waves-effect waves-light">Salvar</button>
                </div><!-- /.modal-footer -->
            </form>
        </div><!-- /.modal-content -->
    </div><!-- /.modal-dialog -->
</div><!-- /.modal -->